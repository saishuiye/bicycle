<!DOCTYPE html>
<html>
<head>
    <title>盐城自行车站点分布</title>
    <!-- 引入 echarts.js -->
	<script src="http://api.map.baidu.com/api?v=2.0&ak=fHrNQj6DHTjZtfTvfqbsuvTzKc5V9SBl"></script>
    <script src="{{ url_for('static',filename='js/echarts.min.js') }}"></script>
  <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>

</head>
<body >
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="width: 100%;height:900px;"></div>

<script>
 var myChart = echarts.init(document.getElementById('main'));

var data = [
{name:'1',value:20},
{name:'5',value:20},
{name:'6',value:20},
{name:'7',value:20},
{name:'8',value:20},
{name:'9',value:20},
{name:'10',value:20},
{name:'12',value:20},
{name:'14',value:20},
{name:'15',value:20},
{name:'16',value:20},
{name:'17',value:20},
{name:'18',value:20},
{name:'19',value:20},
{name:'20',value:20},
{name:'21',value:20},
{name:'22',value:20},
{name:'23',value:20},
{name:'25',value:20},
{name:'26',value:20},
{name:'27',value:20},
{name:'28',value:20},
{name:'29',value:20},
{name:'30',value:20},
{name:'31',value:20},
{name:'34',value:20},
{name:'35',value:20},
{name:'36',value:20},
{name:'37',value:20},
{name:'38',value:20},
{name:'39',value:20},
{name:'40',value:20},
{name:'41',value:20},
{name:'42',value:20},
{name:'43',value:20},
{name:'44',value:20},
{name:'45',value:20},
{name:'46',value:20},
{name:'47',value:20},
{name:'48',value:20},
{name:'50',value:20},
{name:'51',value:20},
{name:'53',value:20},
{name:'54',value:20},
{name:'55',value:20},
{name:'56',value:20},
{name:'57',value:20},
{name:'58',value:20},
{name:'59',value:20},
{name:'60',value:20},
{name:'61',value:20},
{name:'62',value:20},
{name:'63',value:20},
{name:'64',value:20},
{name:'65',value:20},
{name:'66',value:20},
{name:'67',value:20},
{name:'68',value:20},
{name:'69',value:20},
{name:'70',value:20},
{name:'71',value:20},
{name:'73',value:20},
{name:'74',value:20},
{name:'75',value:20},
{name:'76',value:20},
{name:'77',value:20},
{name:'78',value:20},
{name:'80',value:20},
{name:'81',value:20},
{name:'83',value:20},
{name:'85',value:20},
{name:'86',value:20},
{name:'88',value:20},
{name:'92',value:20},
{name:'93',value:20},
{name:'95',value:20},
{name:'96',value:20},
{name:'97',value:20},
{name:'98',value:20},
{name:'99',value:20},
{name:'100',value:20},
{name:'101',value:20},
{name:'102',value:20},
{name:'103',value:20},
{name:'105',value:20},
{name:'106',value:20},
{name:'107',value:20},
{name:'108',value:20},
{name:'109',value:20},
{name:'110',value:20},
{name:'111',value:20},
{name:'115',value:20},
{name:'119',value:20},
{name:'120',value:20},
{name:'121',value:20},
{name:'122',value:20},
{name:'123',value:20},
{name:'124',value:20},
{name:'125',value:20},
{name:'126',value:20},
{name:'127',value:20},
{name:'128',value:20},
{name:'129',value:20},
{name:'130',value:20},
{name:'131',value:20},
{name:'132',value:20},
{name:'133',value:20},
{name:'134',value:20},
{name:'135',value:20},
{name:'136',value:20},
{name:'138',value:20},
{name:'140',value:20},
{name:'141',value:20},
{name:'142',value:20},
{name:'143',value:20},
{name:'144',value:20},
{name:'145',value:20},
{name:'147',value:20},
{name:'149',value:20},
{name:'150',value:20},
{name:'151',value:20},
{name:'152',value:20},
{name:'153',value:20},
{name:'155',value:20},
{name:'156',value:20},
{name:'157',value:20},
{name:'158',value:20},
{name:'159',value:20},
{name:'160',value:20},
{name:'161',value:20},
{name:'162',value:20},
{name:'163',value:20},
{name:'164',value:20},
{name:'165',value:20},
{name:'166',value:20},
{name:'167',value:20},
{name:'168',value:20},
{name:'169',value:20},
{name:'170',value:20},
{name:'171',value:20},
{name:'172',value:20},
{name:'173',value:20},
{name:'174',value:20},
{name:'175',value:20},
{name:'177',value:20},
{name:'178',value:20},
{name:'179',value:20},
{name:'180',value:20},
{name:'181',value:20},
{name:'182',value:20},
{name:'183',value:20},
{name:'184',value:20},
{name:'185',value:20},
{name:'186',value:20},
{name:'187',value:20},
{name:'188',value:20},
{name:'189',value:20},
{name:'190',value:20},
{name:'191',value:20},
{name:'192',value:20},
{name:'194',value:20},
{name:'195',value:20},
{name:'196',value:20},
{name:'197',value:20},
{name:'198',value:20},
{name:'199',value:20},
{name:'200',value:20},
{name:'201',value:20},
{name:'202',value:20},
{name:'203',value:20},
{name:'209',value:20},
{name:'210',value:20},
{name:'211',value:20},
{name:'213',value:20},
{name:'216',value:20},
{name:'217',value:20},
{name:'218',value:20},
{name:'219',value:20},
{name:'220',value:20},
{name:'221',value:20},
{name:'222',value:20},
{name:'223',value:20},
{name:'224',value:20},
{name:'225',value:20},
{name:'229',value:20},
{name:'231',value:20},
{name:'236',value:20},
{name:'237',value:20},
{name:'239',value:20},
{name:'240',value:20},
{name:'241',value:20},
{name:'242',value:20},
{name:'246',value:20},
{name:'247',value:20},
{name:'248',value:20},
{name:'249',value:20},
{name:'250',value:20},
{name:'252',value:20},
{name:'255',value:20},
{name:'256',value:20},
{name:'260',value:20},
{name:'261',value:20},
{name:'262',value:20},
{name:'263',value:20},
{name:'265',value:20},
{name:'266',value:20},
{name:'268',value:20},
{name:'269',value:20},
{name:'270',value:20},
{name:'271',value:20},
{name:'272',value:20},
{name:'274',value:20},
{name:'275',value:20},
{name:'277',value:20},
{name:'281',value:20},
{name:'285',value:20},
{name:'287',value:20},
{name:'288',value:20},
{name:'290',value:20},
{name:'293',value:20},
{name:'295',value:20},
{name:'297',value:20},
{name:'298',value:20},
{name:'299',value:20},
{name:'300',value:20},
{name:'301',value:20},
{name:'302',value:20},
{name:'303',value:20},
{name:'305',value:20},
{name:'306',value:20},
{name:'308',value:20},
{name:'309',value:20},
{name:'310',value:20},
{name:'311',value:20},
{name:'313',value:20},
{name:'314',value:20},
{name:'315',value:20},
{name:'318',value:20},
{name:'319',value:20},
{name:'320',value:20},
{name:'321',value:20},
{name:'322',value:20},
{name:'323',value:20},
{name:'324',value:20},
{name:'326',value:20},
{name:'329',value:20},
{name:'332',value:20},
{name:'333',value:20},
{name:'334',value:20},
{name:'337',value:20},
{name:'339',value:20},
{name:'342',value:20},
{name:'343',value:20},
{name:'353',value:20},
{name:'354',value:20},
{name:'355',value:20},
{name:'357',value:20},
{name:'359',value:20},
{name:'361',value:20},
{name:'366',value:20},
{name:'367',value:20},
{name:'368',value:20},
{name:'370',value:20},
{name:'378',value:20},
{name:'382',value:20},
{name:'387',value:20},
{name:'395',value:20},
{name:'396',value:20},
{name:'397',value:20},
{name:'398',value:20},
{name:'399',value:20},
{name:'417',value:20}
];

var geoCoordMap = {
 '1':[120.168799,33.354391],
'5':[120.153019,33.364616],
'6':[120.157191,33.364138],
'7':[120.154815,33.361177,],
'8':[120.155065,33.357925,],
'9':[120.161685,33.353931,],
'10':[120.167861,33.349335,],
'12':[120.172953,33.341257],
'14':[120.183159,33.33281],
'15':[120.186353,33.326595],
'16':[120.160166,33.369124,],
'17':[120.166941,33.364783,],
'18':[120.166032,33.359967],
'19':[120.172599,33.354709,],
'20':[120.177801,33.357044,],
'21':[120.184546,33.350928],
'22':[120.182409,33.341503],
'23':[120.186371,33.337744],
'25':[120.196008,33.331092],
'26':[120.198549,33.32676],
'27':[120.168362,33.375342,],
'28':[120.168537,33.374091],
'29':[120.120574,33.399209],
'30':[120.177061,33.369055],
'31':[120.17881,33.363859],
'34':[120.182986,33.373868,],
'35':[120.18905,33.366453],
'36':[120.140832,33.357781],
'37':[120.151868,33.343761],
'38':[120.143907,33.363293],
'39':[120.14578,33.359119],
'40':[120.150431,33.355113],
'41':[120.152204,33.350986,],
'42':[120.160913,33.365806,],
'43':[120.161724,33.362943,],
'44':[120.1637,33.358636,],
'45':[120.169845,33.367],
'46':[120.187535,33.348956],
'47':[120.194512,33.337305],
'48':[120.189481,33.341939],
'50':[120.166538,33.353088,],
'51':[120.153663,33.398638,],
'53':[120.151672,33.363239],
'54':[120.164776,33.370081,],
'55':[120.155217,33.363964,],
'56':[120.160011,33.344307,],
'57':[120.165078,33.360643],
'58':[120.143295,33.393225],
'59':[120.137967,33.392192],
'60':[120.16169,33.347599],
'61':[120.174318,33.329051],
'62':[120.183578,33.353851,],
'63':[120.175798,33.345092,],
'64':[120.173874,33.348442,],
'65':[120.170602,33.348944],
'66':[120.166864,33.34553,],
'67':[120.182213,33.345183,],
'68':[120.178143,33.344789],
'69':[120.170999,33.336837],
'70':[120.170989,33.336847],
'71':[120.161778,33.332397],
'73':[120.179344,33.33908],
'74':[120.192596,33.334977],
'75':[120.194193,33.335883],
'76':[120.162989,33.353818],
'77':[120.18846,33.335256],
'78':[120.177593,33.332291],
'80':[120.177749,33.335311],
'81':[120.148993,33.349679],
'83':[120.166511,33.341485],
'85':[120.187483,33.313051],
'86':[120.189293,33.360032,],
'88':[120.167471,33.343375,],
'92':[120.148606,33.407308],
'93':[120.152571,33.406144],
'95':[120.159855,33.403893],
'96':[120.144293,33.386595],
'97':[120.136481,33.403937],
'98':[120.146188,33.397103,],
'99':[120.161669,33.397042],
'100':[120.159854,33.395762],
'101':[120.182712,33.381931],
'102':[120.159489,33.369525],
'103':[120.155822,33.361281,],
'105':[120.159201,33.372692],
'106':[120.156315,33.372165],
'107':[120.157041,33.364138],
'108':[120.177891,33.357014],
'109':[120.221699,33.419579,],
'110':[120.143242,33.389484],
'111':[120.139664,33.367268],
'115':[120.170737,33.338673],
'119':[120.134086,33.401087],
'120':[120.139471,33.399875],
'121':[120.14686,33.400999],
'122':[120.15554,33.372982],
'123':[120.159613,33.407865],
'124':[120.16421,33.401827],
'125':[120.166027,33.399014],
'126':[120.164834,33.395065,],
'127':[120.169886,33.388627],
'128':[120.168565,33.385593],
'129':[120.173413,33.384006,],
'130':[120.180641,33.388149,],
'131':[120.159705,33.387726],
'132':[120.162295,33.382887,],
'133':[120.159659,33.382041],
'134':[120.152006,33.381594],
'135':[120.146189,33.377188],
'136':[120.142408,33.376256,],
'138':[120.134576,33.37354],
'140':[120.159765,33.387626],
'141':[120.159634,33.390369,],
'142':[120.169107,33.389446],
'143':[120.158288,33.396172],
'144':[120.15699,33.40277],
'145':[120.16257,33.400114],
'147':[120.147916,33.399382],
'149':[120.140444,33.392073],
'150':[120.161686,33.39699],
'151':[120.137483,33.372824,],
'152':[120.158458,33.399098],
'153':[120.155648,33.398556],
'155':[120.150081,33.39502],
'156':[120.138477,33.391279,],
'157':[120.199975,33.327918,],
'158':[120.153153,33.375396],
'159':[120.150276,33.38922],
'160':[120.148901,33.393869],
'161':[120.212232,33.366727],
'162':[120.14022,33.403248],
'163':[120.149982,33.407865],
'164':[120.13822,33.388336],
'165':[120.142788,33.397787],
'166':[120.142884,33.397491],
'167':[120.145039,33.384027],
'168':[120.146702,33.372217],
'169':[120.147277,33.372345,],
'170':[120.144763,33.381926,],
'171':[120.145241,33.368687],
'172':[120.144531,33.375752],
'173':[120.164323,33.359636],
'174':[120.127827,33.386354],
'175':[120.137906,33.400893],
'177':[120.138443,33.370043],
'178':[120.135012,33.37805],
'179':[120.167986,33.395513],
'180':[120.164979,33.393005],
'181':[120.155029,33.363014,],
'182':[120.164557,33.35066],
'183':[120.152131,33.391173],
'184':[120.147322,33.389731],
'185':[120.143605,33.386959],
'186':[120.142561,33.388755,],
'187':[120.136168,33.3873],
'188':[120.13088,33.387606],
'189':[120.103281,33.381098],
'190':[120.125202,33.379613],
'191':[120.129594,33.380609],
'192':[120.11171,33.380401],
'194':[120.155724,33.3896],
'195':[120.144931,33.40195],
'196':[120.142931,33.406609],
'197':[120.152332,33.408888],
'198':[120.147281,33.404232],
'199':[120.139829,33.408369],
'200':[120.14767,33.398286],
'201':[120.163152,33.39086],
'202':[120.220796,33.382764],
'203':[120.244684,33.386767],
'209':[120.246788,33.36456],
'210':[120.243008,33.362844],
'211':[120.236668,33.37387],
'213':[120.212399,33.373935],
'216':[120.239303,33.385221],
'217':[120.239076,33.39356],
'218':[120.237049,33.388603],
'219':[120.223831,33.389791],
'220':[120.223838,33.38573],
'221':[120.223768,33.388464],
'222':[120.219212,33.384906],
'223':[120.1631,33.39086],
'224':[120.209221,33.374741],
'225':[120.214031,33.374242],
'229':[120.253238,33.340553],
'231':[120.24552,33.387242],
'236':[120.209221,33.374841],
'237':[120.148146,33.400508],
'239':[120.129307,33.372628],
'240':[120.172723,33.388996],
'241':[120.140434,33.392093],
'242':[120.136021,33.393231],
'246':[120.150234,33.37765],
'247':[120.164075,33.36205],
'248':[120.168414,33.361479],
'249':[120.164208,33.353956],
'250':[120.184546,33.350428],
'252':[120.131431,33.428188],
'255':[120.219372,33.387929],
'256':[120.173176,33.39729],
'260':[120.216728,33.394139,],
'261':[120.2085,3,33.396517],
'262':[120.204718,33.394786],
'263':[120.167121,33.353517],
'265':[120.189118,33.400528],
'266':[120.198461,33.397282],
'268':[120.192555,33.343269],
'269':[120.138974,33.369756],
'270':[120.130355,33.371212],
'271':[120.138737,33.38178],
'272':[120.1369,33.421059],
'274':[120.144444,33.41994,],
'275':[120.200697,33.393916],
'277':[120.120504,33.399299],
'281':[120.196508,33.331092],
'285':[120.177384,33.322596],
'287':[120.183911,33.313901],
'288':[120.148963,33.367858],
'290':[120.186184,33.327504],
'293':[120.187155,33.339501,],
'295':[120.168578,33.354715],
'297':[120.188434,33.370713],
'298':[120.191873,33.365096],
'299':[120.192585,33.364189],
'300':[120.145758,33.340306],
'301':[120.149395,33.333865],
'302':[120.157236,33.328351],
'303':[120.165799,33.344267],
'305':[120.163306,33.340699,],
'306':[120.153728,33.343297],
'308':[120.13476,33.355422],
'309':[120.160232,33.344315],
'310':[120.160282,33.344315],
'311':[120.160202,33.344315],
'313':[120.146919,33.387708],
'314':[120.133256,33.37335],
'315':[120.134681,33.380668],
'318':[120.139612,33.345636],
'319':[120.156983,33.339754],
'320':[120.154895,33.397039],
'321':[120.144621,33.392464],
'322':[120.147855,33.390192,],
'323':[120.1724,33.360034],
'324':[120.167996,33.395513],
'326':[120.182927,33.374959],
'329':[120.196496,33.363376],
'332':[120.164994,33.33542],
'333':[120.170297,33.334537],
'334':[120.201995,33.327199,],
'337':[120.177932,33.342721],
'339':[120.16001,33.329619],
'342':[120.11823,33.311692],
'343':[120.155569,33.347155],
'353':[120.170397,33.334517],
'354':[120.151838,33.330811],
'355':[120.234027,33.288983],
'357':[120.147978,33.414958],
'359':[120.138072,33.381399],
'361':[120.189273,33.346379],
'366':[120.138714,33.42497],
'367':[120.214239,33.404622],
'368':[120.209704,33.395258],
'370':[120.214358,33.406114],
'378':[120.18213,33.408853],
'382':[120.236548,33.382938],
'387':[120.224752,33.375652],
'395':[120.213734,33.382504],
'396':[120.162207,33.390764],
'397':[120.141895,33.347822],
'398':[120.180817,33.340651],
'399':[120.137524,33.387796],
'417':[120.177977,33.359098]
};

var convertData = function (data) {
    var res = [];
    for (var i = 0; i < data.length; i++) {
        var geoCoord = geoCoordMap[data[i].name];
        if (geoCoord) {
            res.push({
                name: data[i].name,
                value: geoCoord.concat(data[i].value)
            });
        }
    }
    return res;
};

function renderItem(params, api) {
    var coords = [
        [116.7,39.53],
        [103.73,36.03],
        [112.91,27.87],
        [120.65,28.01],
        [119.57,39.95]
    ];
    var points = [];
    for (var i = 0; i < coords.length; i++) {
        points.push(api.coord(coords[i]));
    }
    var color = api.visual('color');

    return {
        type: 'polygon',
        shape: {
            points: echarts.graphic.clipPointsByRect(points, {
                x: params.coordSys.x,
                y: params.coordSys.y,
                width: params.coordSys.width,
                height: params.coordSys.height
            })
        },
        style: api.style({
            fill: color,
            stroke: echarts.color.lift(color)
        })
    };
}

option = {
    backgroundColor: '#404a59',
    title: {
        text: '盐城自行车站点分布图',
        left: 'center',
        textStyle: {
            color: '#fff'
        }
    },
    tooltip : {
        trigger: 'item'
    },
    bmap: {
        center: [104.114129, 37.550339],
        zoom: 5,
        roam: true,

    },

    series : [
        {
            name: '自行车站点',
            type: 'effectScatter',
            coordinateSystem: 'bmap',
            data: convertData(data.sort(function (a, b) {
                return b.value - a.value;
            }).slice(0, 270)),
            symbolSize: function (val) {
                return val[2] / 2;
            },
            rippleEffect: {
                brushType: 'stroke'
            },
            hoverAnimation: true,
            label: {
                normal: {
                    formatter: '{b}',
                    position: 'right',
                    show: true
                }
            },
            itemStyle: {
                normal: {
                    color: '#ff0000',
                    shadowBlur: 10,
                    shadowColor: '#333'
                }
            },
            zlevel: 1

        }
    ]
};
myChart.setOption(option);
// 获取百度地图实例，使用百度地图自带的控件
var bmap = myChart.getModel().getComponent('bmap').getBMap();
bmap.addControl(new BMap.MapTypeControl());
//调用百度的方法，使用bmap对象
var point = new BMap.Point(120.13, 33.38);
bmap.centerAndZoom(point, 15);
</script>
</body>
</html>